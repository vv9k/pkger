[metadata]
name = "pkger"
description = "pkger"
arch = "x86_64"
license = "MIT"
version = "0.1.0"
maintainer = "Wojciech KÄ™pka <wojciech@wkepka.dev>"
git = "https://github.com/wojciechkepka/pkger.git"
provides = ["pkger"]
images = [
    { name = "centos8", target = "rpm" },
    { name = "debian10", target = "deb" },
    { name = "arch", target = "pkg" }
]

[metadata.build_depends]
all = ["gcc", "pkg-config", "git"]
centos8 = ["cargo", "openssl-devel"]
debian10 = ["curl", "libssl-dev"]
arch = ["cargo"]
pkger-rpm = ["cargo", "openssl-devel"]
pkger-deb = ["curl", "libssl-dev"]

[configure]
steps = [
    {cmd = "curl -o /tmp/install_rust.sh https://sh.rustup.rs", images = ["debian10"], deb = true },
    {cmd = "sh /tmp/install_rust.sh -y --default-toolchain stable", images = ["debian10"], deb = true }
]

[build]
steps = [
    {cmd = "cargo build --color=never", images = ["centos8", "arch"], rpm = true },
    {cmd = "$HOME/.cargo/bin/cargo build --color=never", images = ["debian10"], deb = true }
]

[install]
steps = [
    "mkdir -p usr/bin",
    "install -m755 $PKGER_BLD_DIR/target/debug/pkger usr/bin/"
]
