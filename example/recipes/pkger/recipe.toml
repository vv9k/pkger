[metadata]
name = "pkger"
description = "pkger"
arch = "x86_64"
license = "MIT"
version = "0.1.0"
revision = "0"
maintainer = "Wojciech KÄ™pka <wojciech@wkepka.dev>"
source = ""
git = "https://github.com/wojciechkepka/pkger.git"
exclude = ["share", "info"]
provides = ["pkger"]
images = [
	{ name = "centos8", target = "rpm" },
    { name = "debian10", target = "deb" }
]

[metadata.build_depends]
all = ["gcc", "pkg-config", "git"]
centos8 = ["cargo", "openssl-devel"]
debian10 = ["curl", "libssl-dev"]

[configure]
steps = [
    {cmd = "curl -o /tmp/install_rust.sh https://sh.rustup.rs", images = ["debian10"]},
	{cmd = "sh /tmp/install_rust.sh -y --default-toolchain stable", images = ["debian10"]}
]

[build]
steps = [
	{cmd = "cargo build --color=never", images = ["centos8"]},
	{cmd = "$HOME/.cargo/bin/cargo build --color=never", images = ["debian10"]}
]

[install]
steps = [
    "mkdir -p usr/bin",
    "install -m755 $PKGER_BLD_DIR/target/debug/pkger usr/bin/"
]
